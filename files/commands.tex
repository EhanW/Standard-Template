% Mark sections of captions for referring to divisions of figures
\newcommand{\figleft}{{\bf Left: }}
\newcommand{\figcenter}{{\bf Center: }}
\newcommand{\figright}{{\bf Right: }}
\newcommand{\figtop}{{\bf Top: }}
\newcommand{\figmiddle}{{\bf Middle: }}
\newcommand{\figbottom}{{\bf Bottom: }}
\newcommand{\captiona}{{\em (a)}}
\newcommand{\captionb}{{\em (b)}}
\newcommand{\captionc}{{\em (c)}}
\newcommand{\captiond}{{\em (d)}}

\newcommand{\train}{\mathcal{D}}
\newcommand{\valid}{\mathcal{D_{\mathrm{valid}}}}
\newcommand{\test}{\mathcal{D_{\mathrm{test}}}}
\def\eps{{\epsilon}}
% The true underlying data generating distribution
\newcommand{\pdata}{p_{\rm{data}}}
% The empirical distribution defined by the training set
\newcommand{\ptrain}{\hat{p}_{\rm{data}}}
\newcommand{\Ptrain}{\hat{P}_{\rm{data}}}
% The model distribution
\newcommand{\pmodel}{p_{\rm{model}}}
\newcommand{\Pmodel}{P_{\rm{model}}}
\newcommand{\ptildemodel}{\tilde{p}_{\rm{model}}}
% Stochastic autoencoder distributions
\newcommand{\pencode}{p_{\rm{encoder}}}
\newcommand{\pdecode}{p_{\rm{decoder}}}
\newcommand{\precons}{p_{\rm{reconstruct}}}

\newcommand{\laplace}{\mathrm{Laplace}} % Laplace distribution

\newcommand{\Lzero}{L_0}
\newcommand{\Lone}{L_1}
\newcommand{\Ltwo}{L_2}
\newcommand{\Lp}{L_p}
\newcommand{\Linfty}{L_\infty}

\newcommand{\parents}{Pa} % See usage in notation.tex. Chosen to match Daphne's book.


%%%%%%%%%%%%%%% standard abbreviations %%%%%%%%%%%%%%%
\newcommand{\ans}[1]{{\color{red} Ans: #1}}
% \newcommand{\att}{\texttt{att}}
\newcommand{\Breg}{\mathrm{D}}
\newcommand{\emp}{\mathop{\mathrm{emp}}}
\newcommand{\err}{{\sf err}}
\newcommand{\Fix}{\ensuremath{\mathsf{Fix}}}
\newcommand{\fl}{\mathsf{FL}} 
\newcommand{\gl}{\mathsf{GL}}
\newcommand{\hinge}{\mathop{\mathrm{hinge}}}
\newcommand{\iter}{\texttt{iter}}
\newcommand{\logit}{\ensuremath{\mathtt{logit}}}
\newcommand{\JS}{\ensuremath{\mathtt{JS}}}
\newcommand{\KL}{\ensuremath{\mathsf{KL}}}
\newcommand{\KW}{\ensuremath{\mathsf{W}}}
\newcommand{\len}{\mathsf{len}}
\newcommand{\link}{\mathtt{link}}
\newcommand{\loss}{\mathop{\mathrm{loss}}}
\newcommand{\MAP}{\ensuremath{\mathsf{MAP}}}
\newcommand{\ML}{\ensuremath{\mathsf{MLE}}}
\newcommand{\nil}{\textsc{Nil}}
\newcommand{\NLL}{\ensuremath{\mathtt{NLL}}}
\newcommand{\perf}{\mathsf{perf}}
\newcommand{\predn}{\mathsf{pred}}
\newcommand{\qvar}{\mathrm{QV}} % quadratic variation
\newcommand{\reg}{\mathop{\mathrm{reg}}}
\newcommand{\RKL}{\ensuremath{\mathsf{LK}}}
\newcommand{\relu}{\mathtt{ReLU}}
\newcommand{\sgm}{\ensuremath{\mathtt{sgm}}}
\newcommand{\sm}{\ensuremath{\mathtt{softmax}}}
\newcommand{\spm}{\ensuremath{\mathtt{sparsemax}}}
\newcommand{\softmax}{\ensuremath{\mathtt{Softmax}}}
\newcommand{\SC}[1][\eta]{\mathsf{SC}_{#1}}  % strong convexity
\renewcommand{\SS}[1][\eta]{\mathsf{SS}_{1/#1}} % strong smoothness
\newcommand{\Ltwobar}{\overline{M^2}}
\newcommand{\UKL}{\ensuremath{\widetilde{\KL}}}


%%%%%%%%%%%%%%% Mathematical Operations %%%%%%%%%%%%%%%
\newcommand{\adj}{\mathop{\mathrm{adj}}}
\newcommand{\arginf}{\mathop{\mathrm{arginf}}}
\newcommand{\argmax}{\mathop{\mathrm{argmax}}}
\newcommand{\argmin}{\mathop{\mathrm{argmin}}}
\newcommand{\argsup}{\mathop{\mathrm{argsup}}}
\newcommand{\Ball}[1][]{\mathcal{B}_{#1}}
\newcommand{\baru}[1]{\underset{\bar{}}{#1}}
\newcommand{\bd}{\mathop{\mathrm{bd}}}
\newcommand{\card}[1]{\abs{#1}}
\newcommand{\cc}[1]{\mathrm{\overline{conv}}#1}
\newcommand{\ccp}{\Gamma_0} % closed convex proper
\def\ci{\perp\!\!\!\perp} % conditional independence
\newcommand{\cl}{\mathop{\mathrm{cl}}}
\newcommand{\co}{\mathop{\mathrm{co}}}
\newcommand{\cone}{\mathop{\mathrm{cone}}}
\newcommand{\const}{\mathop{\mathrm{constant}}}
\newcommand{\core}{\mathop{\mathrm{core}}}
\newcommand{\conv}{\mathop{\mathrm{conv}}}
\newcommand{\Cov}{\mathop{\mathrm{Cov}}}
\newcommand{\dep}{\mathsf{dep}} % dependence
\newcommand{\diag}{\mathop{\mathrm{diag}}}
\newcommand{\Diag}{\mathop{\mathrm{Diag}}}
\newcommand{\diam}{\mathop{\textrm{diam}}}
\newcommand{\dist}{\ensuremath{\mathrm{dist}}}
\newcommand{\dom}{\mathop{\mathrm{dom}}}
\newcommand{\env}[2][\eta]{\mathrm{M}^{#1}_{#2}}
\newcommand{\epi}{\mathop{\mathrm{epi}}}
\newcommand{\eproof}{$\null\hfill\blacksquare$}
\newcommand{\gph}{\mathop{\mathrm{gph}}}
\newcommand{\grad}{{\nabla}}
\newcommand{\gradtil}{{\tilde{\grad}}}
\newcommand{\id}{\ensuremath{\mathrm{Id}}} % Identity
\newcommand{\Img}{\ensuremath{\mathrm{Im}}}
\newcommand{\ind}{\mathcal{I}}
\newcommand{\intr}{\mathop{\mathrm{int}}}
\newcommand{\Iver}[1]{[\![#1]\!]} % Iverson predicate
\newcommand{\Ker}{\ensuremath{\mathrm{Ker}}}
\newcommand{\lhs}{\mathrm{LHS}}
\usepackage{actuarialsymbol}
\newcommand{\Lsub}[2][]{\actsymb[][#1]{#2}{}{}} % Lipschitz constant
\newcommand{\mat}{\mathfrak{M}}
\newcommand{\maxi}{\mathop{\mathrm{maximize}}}
\newcommand{\mini}{\mathop{\mathrm{minimize}}}
\newcommand{\med}{\mathop{\mathrm{med}}}
\newcommand{\MED}{{\text{MED}}}
\newcommand{\mf}[1][f]{\mbox{\textcolor{red}{-}}#1} % minus function
\providecommand*{\mgrad}{\mathbin{\overline{\vee}\!}} % metric gradient
\newcommand{\ncone}{\mathcal{N}} % normal cone
\newcommand{\nnz}{\mathop{\mathrm{nnz}}}
\newcommand{\pa}[1][\eta]{\mathrm{A}^{#1}} % prox-avg
\newcommand{\pos}{\mathop{\mathrm{pos}}}
\newcommand{\pred}[1]{\left\llbracket#1\right\rrbracket}
\newcommand{\proj}{\mathrm{P}}
\newcommand{\prox}[2][\eta]{\mathrm{P}^{#1}_{#2}}
\newcommand{\qcc}[1]{\mathrm{\overline{qconv}}#1}
\newcommand{\ran}{\mathrm{ran}}
\newcommand{\oeps}{\overline{\epsilon}} 
\newcommand{\of}[1][f]{\overline{#1}} % overline function
\newcommand{\opt}{\mathrm{opt}}
% \newcommand{\ran}{\mathop{\mathrm{rge}}}
\newcommand{\rank}{\mathop{\mathrm{rank}}}
\newcommand{\rcore}{\mathop{\mathrm{rcore}}}
\def\restrict#1{\raise-.5ex\hbox{\ensuremath|}_{#1}}
\newcommand{\rhs}{\mathrm{RHS}}
\newcommand{\ri}{\mathop{\mathrm{ri}}}
\newcommand{\rint}{\mathop{\mathrm{rint}}}
\newcommand{\sat}{\mathsf{sat}}
\newcommand{\sgn}{\mathop{\mathrm{sign}}}
\newcommand{\sign}{\mathop{\mathrm{sign}}}
\DeclareMathOperator*{\sol}{\mathrm{SOL}}
\newcommand{\spe}{\ensuremath{\mathrm{sp}}}
\newcommand{\srank}{\mathop{\mathrm{srank}}}
\newcommand{\sri}{\mathop{\mathrm{sri}}}
\newcommand{\st}{~\mathrm{s.t.}~}
\newcommand{\supp}{\mathop{\mathrm{supp}}}
\newcommand{\tn}[1]{|\!\!|\!\!|#1|\!\!|\!\!|} % triple norm
\newcommand{\tr}{\mathop{\mathrm{tr}}}
\newcommand{\traj}{\mathop{\mathrm{Traj}}}
\newcommand{\tvn}{\ensuremath{\mathrm{TV}}} % total variation norm
\newcommand{\ueps}{\underline{\epsilon}}
\newcommand{\uf}[1][f]{\underline{#1}} % underline function
\newcommand{\var}{\mathop{\mathrm{Var}}}
\newcommand{\vect}{\mathop{\mathrm{vec}}}
\DeclareMathOperator*{\vi}{\mathrm{VI}}
\newcommand{\where}{{\quad \text{where} \quad}}
% \newcommand{\ln}{\mathop{\mathrm{ln}}}
\newcommand{\prob}{\mathop\mathrm{Pr}} % Probability
\newcommand{\EE}{\mathds{E}} % Expectation



%%%%%%%%%%%%%%% trigonometric %%%%%%%%%%%%%%%
% \DeclareMathOperator{\arcsin}{arcsin}   % already defined
% \DeclareMathOperator{\arccos}{arccos}% already defined
% \DeclareMathOperator{\arctan}{arctan} % already defined
\DeclareMathOperator{\arccot}{arccot}
\DeclareMathOperator{\arcsinh}{arcsinh}
\DeclareMathOperator{\arccosh}{arccosh}
\DeclareMathOperator{\arctanh}{arctanh}
\DeclareMathOperator{\arccoth}{arccoth}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% THEOREMS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{assumption}[theorem]{Assumption}
\newtheorem{fact}[theorem]{Fact}
\newtheorem{example}[theorem]{Example}
\newtheorem{exercise}[theorem]{Exercise}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{hypothesis}[theorem]{Hypothesis}

\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{note}[theorem]{Note}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% colors
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\red}[1]{\textcolor{red}{#1}}
\newcommand{\orange}[1]{\textcolor{orange}{#1}}
\newcommand{\yellow}[1]{\textcolor{yellow}{#1}}
\newcommand{\green}[1]{\textcolor{green}{#1}}
\newcommand{\blue}[1]{\textcolor{blue}{#1}}
\newcommand{\cyan}[1]{\textcolor{cyan}{#1}}
\newcommand{\purple}[1]{\textcolor{purple}{#1}}
\newcommand{\teal}[1]{\textcolor{teal}{#1}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% author footnote
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \newcommand\CoAuthorMark{\footnotemark[\arabic{footnote}]}
\newcommand{\authorfootnote}[1]{%
  \begingroup
  \renewcommand{\thefootnote}{}%
  \footnotetext{#1}%
  \addtocounter{footnote}{-1}%
  \endgroup
}
\authorfootnote{\textsuperscript{*}Equal contribution.
\textsuperscript{\textdagger}Correspondence author.
\textsuperscript{\textdaggerdbl}Listed in alphabetical order.
}

% frac without line
\newcommand{\mfrac}[2]{\genfrac{}{}{0pt}{}{#1}{#2}}

%%%%%%%%%%%%%%% Short Forms %%%%%%%%%%%%%%%
\newcommand{\aka}{{a.k.a.}}
\newcommand{\cf}{{cf.}}
\newcommand{\ea}{{et al.}}
\newcommand{\eg}{{e.g.}}
\newcommand{\etc}{{etc.}}
\newcommand{\ie}{{i.e.}}
\newcommand{\iid}{{i.i.d.}}
\newcommand{\wrt}{{w.r.t.}}
\newcommand{\vs}{{vs.}}

%%%%%%%%%%%%%%% Brackets %%%%%%%%%%%%%%%
\newcommand{\abr}[1]{\left|#1\right|}
\newcommand{\abs}[1]{\left|#1\right|}
\newcommand{\cbr}[1]{\left\{#1\right\}}
\newcommand{\ccc}[1]{|\!|\!|#1|\!|\!|}
\newcommand{\ceil}[1]{\left\lceil #1 \right\rceil}
\newcommand{\dual}[2]{\left\langle #1;#2 \right\rangle}
\newcommand{\dualnorm}[1]{\left\|#1\right\|_{\circ}}
\newcommand{\floor}[1]{\left\lfloor #1 \right\rfloor}
\newcommand{\inner}[2]{\left\langle #1,#2 \right\rangle}
\newcommand{\nbr}[1]{\left\|#1\right\|}
\newcommand{\norm}[1]{\left\|#1\right\|}
\newcommand{\normzero}[1]{\left\|#1\right\|_{0}}
\newcommand{\normone}[1]{\left\|#1\right\|_{1}}
\newcommand{\normtwo}[1]{\left\|#1\right\|_{2}}
\newcommand{\normp}[1]{\left\|#1\right\|_{p}}
\newcommand{\norminfty}[1]{\left\|#1\right\|_{\infty}}

\newcommand{\rbr}[1]{\left(#1\right)}
\newcommand{\sbr}[1]{\left[#1\right]}
\newcommand{\sembrack}[1]{[\![#1]\!]}
\newcommand{\sip}[2]{[#1, #2]}

%%%%%%%%%%%%%%%  Mathematical Constants  %%%%%%%%%%%%%%%
\newcommand{\face}[1][F]{\mathfrak{#1}}
\newcommand{\half}{\frac{1}{2}}
\newcommand{\invsqrttwo}{\frac{1}{\sqrt{2}}}
\newcommand{\one}{\mathbf{1}}  % Identity
\newcommand{\poly}[1][P]{\mathfrak{#1}}
\newcommand{\rmd}{\mathop{}\!\mathrm{d}}
\newcommand{\shalf}{\textstyle\frac{1}{2}}
\newcommand{\sqrttwo}{\sqrt{2}}
\newcommand{\zero}{\mathbf{0}} % Zero


%%%% define capital Greek characters
\DeclareMathSymbol{\Alpha}{\mathalpha}{operators}{"41}
\DeclareMathSymbol{\Beta}{\mathalpha}{operators}{"42}
\DeclareMathSymbol{\Epsilon}{\mathalpha}{operators}{"45}
\DeclareMathSymbol{\Zeta}{\mathalpha}{operators}{"5A}
\DeclareMathSymbol{\Eta}{\mathalpha}{operators}{"48}
\DeclareMathSymbol{\Iota}{\mathalpha}{operators}{"49}
\DeclareMathSymbol{\Kappa}{\mathalpha}{operators}{"4B}
\DeclareMathSymbol{\Mu}{\mathalpha}{operators}{"4D}
\DeclareMathSymbol{\Nu}{\mathalpha}{operators}{"4E}
\DeclareMathSymbol{\Omicron}{\mathalpha}{operators}{"4F}
\DeclareMathSymbol{\Rho}{\mathalpha}{operators}{"50}
\DeclareMathSymbol{\Tau}{\mathalpha}{operators}{"54}
\DeclareMathSymbol{\Chi}{\mathalpha}{operators}{"58}
\DeclareMathSymbol{\omicron}{\mathord}{letters}{"6F}
